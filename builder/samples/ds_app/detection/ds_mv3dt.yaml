# SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


name: "deepstream-app"
model_repo: "/workspace/models"
models:
- name: PeopleNetTransformer
  backend: deepstream/nvinfer
  max_batch_size: 4
  input:
  - name: media_url
    data_type: TYPE_CUSTOM_BINARY_URLS
    dims: [ -1 ]
    optional: true
  - name: mime
    data_type: TYPE_CUSTOM_DS_MIME
    dims: [ -1 ]
    optional: true
  - name: source_config
    data_type: TYPE_CUSTOM_DS_SOURCE_CONFIG
    dims: [ 1 ]
    optional: true
  output:
  - name: output
    data_type: TYPE_CUSTOM_DS_METADATA
    dims: [ -1 ]
  parameters:
    infer_config_path:
      - nvdsinfer_config.yaml
    resize_video: [1080, 1920]
    tracker_config:
      ll_lib_file: /opt/nvidia/deepstream/deepstream/lib/libnvds_nvmultiobjecttracker.so
      ll_config_file: /workspace/models/PeopleNetTransformer/config_tracker.yml
      width: 1920
      height: 1088
      display_tracking_id: true
    # msgbroker_config:
    #   msgbroker_proto_lib_path: /opt/nvidia/deepstream/deepstream/lib/libnvds_kafka_proto.so
    #   msgbroker_conn_str: localhost;9092
    #   msgbroker_topic: mv3dt_ib_app
    #   msgconv_config_path: /opt/nvidia/deepstream/deepstream/sources/apps/sample_apps/deepstream-test5/configs/dstest5_msgconv_sample_config.txt
    #   msgconv_payload_type: 2
    #   msgconv_msg2p_new_api: false
    #   msgconv_frame_interval: 1
    #   msgconv_msg2p_lib: /opt/nvidia/deepstream/deepstream/lib/libnvds_msgconv.so
    perf_config:
      enable_fps_logs: true
      enable_latency_logs: true
    kitti_output_path:
      infer: /workspace/models/PeopleNetTransformer/infer-kitti-dump/
      tracker: /workspace/models/PeopleNetTransformer/tracker-kitti-dump/
    inference_timeout: 1000
    batch_timeout: -1